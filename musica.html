<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Música - LIA</title>
<style>
body{margin:0;padding:;font-family:sans-serif;background:#212121;color:white;}
h1{text-align:center;margin-bottom:20px;}
#searchContainer{display:flex;justify-content:center;margin-bottom:20px;}
#searchContainer input{padding:10px;width:60%;border-radius:5px;border:none;}
#searchContainer button{padding:10px;margin-left:5px;border-radius:5px;border:none;background:darkred;color:white;font-weight:bold;cursor:pointer;transition:0.3s;}
#searchContainer button:hover{background:#ff4d4d;}

#results{display:flex;flex-direction:column;gap:10px;}
.track{background:#333;padding:10px;border-radius:10px;display:flex;align-items:center;gap:15px;transition:0.3s;}
.track:hover{background:#444;}
.track img{width:60px;height:60px;border-radius:10px;flex-shrink:0;}
.track span{flex:1;font-weight:600;}
.track button{
  margin-left:5px;
  padding:8px 12px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
  transition:0.3s;
  display:flex;
  align-items:center;
  gap:5px;
}
.track button.play{background: darkred; color:white;}
.track button.play:hover{background: darkre;}
.track button.download{background:#212121;color:white;}
.track button.download:hover{background:#212121;}
audio{width:100%;margin-top:10px;border-radius:5px;}
header{
  display:flex;
  align-items:center;
  gap:10px;
  padding:0.5rem 1rem;
  font-weight:900;
  background:#1e1e1e;
}
header img{
  width:2rem;
  height:2rem;
  border-radius:20px;
}
header a{
  color:white;
  text-decoration:none;
  margin-left:1rem;
  padding:0.2rem 0.5rem;
  border-radius:5px;
  transition:0.2s;
}
header a:hover{
  background:#ff4d4d;
  color:white;
}

</style>
</head>
<body>
<header>
  <img src="icon512.png" alt="LIA"/>

  <a href="liaison.html">Home</a>
  <a href="gps.html">GPS</a>
  <a href="chatboot.html">Chatboot</a>
</header>

<div id="searchContainer">
<input type="text" id="query" placeholder="Digite o nome da música ou artista">
<button onclick="searchMusic()">Pesquisar</button>
</div>

<div id="results"></div>

<script>
async function searchMusic(){
  const query=document.getElementById("query").value.trim();
  const resultsDiv=document.getElementById("results");
  resultsDiv.innerHTML="Carregando...";
  if(!query){resultsDiv.innerHTML="Digite algo para pesquisar.";return;}

  try{
    const res=await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(query)}&limit=10&media=music`);
    const data=await res.json();
    resultsDiv.innerHTML="";
    if(data.results.length===0){resultsDiv.innerHTML="Nenhuma música encontrada."; return;}

    data.results.forEach(track=>{
      const div=document.createElement("div");
      div.className="track";
      div.innerHTML=`
        <img src="${track.artworkUrl100}" alt="Capa">
        <span>${track.trackName} - ${track.artistName}</span>
        <button class="play"> Ouvir</button>
        <button class="download">Baixar</button>
        <audio src="${track.previewUrl}"></audio>
      `;
      const playBtn=div.querySelector(".play");
      const downloadBtn=div.querySelector(".download");
      const audio=div.querySelector("audio");

      playBtn.addEventListener("click",()=>{
        document.querySelectorAll("audio").forEach(a=>{if(a!==audio)a.pause();});
        audio.paused ? audio.play() : audio.pause();
      });

      downloadBtn.addEventListener("click",()=>{
        const a=document.createElement("a");
        a.href=track.previewUrl;
        a.download=`${track.trackName} - ${track.artistName}.m4a`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      });

      resultsDiv.appendChild(div);
    });
  }catch(err){
    resultsDiv.innerHTML="Erro ao buscar músicas.";
    console.error(err);
  }
}
</script>
</body>
</html>
